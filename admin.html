<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AR Assets Admin</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- เพิ่ม Font Awesome เพื่อใช้ไอคอนกล้อง -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <style>
      body {
        background-color: #f8f9fa;
      }
      .container {
        margin-top: 30px;
        padding: 15px;
      }
      .card {
        margin-bottom: 20px;
        border-radius: 8px;
      }
      .table {
        font-size: 0.9rem;
      }
      .form-control,
      .form-select {
        font-size: 0.9rem;
      }
      .btn-sm {
        font-size: 0.85rem;
      }
      .file-drop-area {
        border: 2px dashed #ccc;
        padding: 20px;
        text-align: center;
        cursor: pointer;
        background-color: #fff;
        border-radius: 8px;
      }
      .file-drop-area.dragover {
        background-color: #e9ecef;
      }
      .home-button {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #2196f3; /* สีฟ้าสดใสเหมือนปุ่มรีเฟรช */
        color: white;
        padding: 12px 16px;
        border: none;
        border-radius: 50%; /* วงกลม */
        cursor: pointer;
        font-size: 20px; /* ขนาดไอคอน */
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* เงา */
        transition: transform 0.3s, background 0.3s; /* เอฟเฟกต์หมุนและเปลี่ยนสี */
      }
      .home-button:hover {
        background: #1976d2; /* สีเข้มเมื่อ hover */
        transform: rotate(360deg); /* หมุน 360 องศาเมื่อ hover */
      }
      .home-button i {
        margin: 0; /* ลบ margin เพื่อให้ไอคอนอยู่กึ่งกลาง */
      }
      #ar-assets-table tbody {
        display: block;
        max-height: 300px; /* ~30px per row for 10 rows */
        overflow-y: auto;
      }
      #ar-assets-table thead,
      #ar-assets-table tbody tr {
        display: table;
        width: 100%;
        table-layout: fixed;
      }
      #ar-assets-table thead {
        width: calc(100% - 1em); /* Adjust for scrollbar width */
      }
      @media (max-width: 576px) {
        .container {
          padding: 10px;
        }
        .table {
          font-size: 0.8rem;
        }
        .btn {
          width: 100%;
          margin-bottom: 10px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1 class="mb-4">จัดการ AR Assets</h1>

      <!-- Form for Create/Update AR Assets -->
      <div class="card">
        <div class="card-header">
          <h2 class="h5">เพิ่ม/แก้ไข Asset</h2>
        </div>
        <div class="card-body">
          <form id="asset-form">
            <input type="hidden" id="asset-id" />
            <div class="mb-3">
              <label for="asset-name" class="form-label">ชื่อ Asset</label>
              <input
                type="text"
                class="form-control"
                id="asset-name"
                required
              />
            </div>
            <div class="mb-3">
              <label for="asset-file" class="form-label">อัปโหลดไฟล์</label>
              <div class="file-drop-area" id="file-drop-area">
                <p>
                  ลากและวางไฟล์ที่นี่ หรือคลิกเพื่อเลือกไฟล์<br />(ไม่เกิน 50
                  mb, ชื่อไฟล์ปกติ, ชื่อไฟล์ไม่ซ้ำ, รองรับเฉพาะ .mp4, .jpg,
                  .jpeg, .png, .mind, .gltf)
                </p>
                <input
                  type="file"
                  id="asset-file"
                  accept=".mp4,.jpg,.jpeg,.png,.mind,.gltf"
                  hidden
                />
              </div>
              <p id="file-name" class="mt-2"></p>
            </div>
            <button type="submit" class="btn btn-primary">บันทึก</button>
            <button type="button" class="btn btn-secondary" id="reset-form">
              รีเซ็ต
            </button>
            <p class="mt-3" id="status-message"></p>
          </form>
        </div>
      </div>

      <!-- Assets Table -->
      <div class="card">
        <div class="card-header">
          <h2 class="h5">รายการ AR Assets</h2>
        </div>
        <div class="card-body">
          <table class="table table-striped table-hover" id="ar-assets-table">
            <thead>
              <tr>
                <th>ชื่อ</th>
                <th>ประเภท</th>
                <th>URL</th>
                <th>การจัดการ</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <!-- Additional Buttons -->
      <div class="card">
        <div class="card-body text-center">
          <a
            href="https://studio.tripo3d.ai/home"
            class="btn btn-info me-2"
            target="_blank"
            >สร้าง Model จาก รูป</a
          >
          <a
            href="https://hiukim.github.io/mind-ar-js-doc/tools/compile"
            class="btn btn-info"
            target="_blank"
            >สร้าง ไฟล์ .mind</a
          >
        </div>
      </div>

      <!-- Update ARData Form -->
      <div class="card">
        <div class="card-header">
          <h2 class="h5">อัปเดต AR Data</h2>
        </div>
        <div class="card-body">
          <form id="ar-data-form">
            <input
              type="hidden"
              id="ar-data-id"
              value="4dce27a0-486c-4d87-a0b7-7c6b66dd210e"
            />
            <div class="mb-3">
              <label for="mind-file-select" class="form-label">Mind File</label>
              <select class="form-select" id="mind-file-select" required>
                <option value="">เลือก Mind File</option>
              </select>
            </div>
            <div id="image-tracking-container">
              <label class="form-label">Image Tracking Targets</label>
              <div class="mb-3" id="target-fields">
                <!-- Dynamic fields will be added here -->
              </div>
              <button
                type="button"
                class="btn btn-secondary mb-3"
                id="add-target"
              >
                เพิ่ม Target
              </button>
            </div>
            <button type="submit" class="btn btn-primary">อัปเดต</button>
            <p class="mt-3" id="ar-data-status"></p>
          </form>
        </div>
      </div>
    </div>

    <!-- ปุ่มกลับหน้าแรก -->
    <button class="home-button" onclick="goToHome()">
      <i class="fas fa-camera"></i>
      <!-- ไอคอนกล้องจาก Font Awesome -->
    </button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="/admin.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.134.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.134.0/examples/js/controls/OrbitControls.js"></script>
    <script src="/modelViewer.js"></script>
    <script src="/admin2.js"></script>
    <script>
      function goToHome() {
        window.location.href = "/";
      }
    </script>
  </body>
</html>
